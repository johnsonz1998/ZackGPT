<div class="app-container">
  <!-- Sidebar -->
  <div class="sidebar">
    <!-- Logo and Title -->
    <div class="sidebar-header">
      <div class="logo" (click)="goHome()">
        <span class="logo-icon">⚡</span>
        <span class="logo-text">ZackGPT</span>
      </div>
    </div>

    <!-- New Chat Button -->
    <div class="new-chat-section">
      <button class="new-chat-btn" (click)="createNewChat()">
        <span class="plus-icon">+</span>
        New chat
      </button>
    </div>

    <!-- Chat List -->
    <div class="chat-list">
      <div *ngFor="let thread of threads" 
           class="chat-item" 
           [class.active]="selectedThread?.id === thread.id"
           (click)="selectThread(thread)">
        <span class="chat-title">{{ thread.title }}</span>
        <button class="delete-btn" (click)="deleteThread(thread.id, $event)">
          <span>×</span>
        </button>
      </div>
      
      <div *ngIf="threads.length === 0" class="no-chats">
        No conversations yet
      </div>
    </div>

    <!-- Bottom Section -->
    <div class="sidebar-bottom">
      <div class="settings-btn" (click)="openSettings()">
        <span class="settings-icon">⚙️</span>
        Settings
      </div>
      <div class="connection-status" [class.connected]="connected">
        {{ connected ? 'Connected' : 'Disconnected' }}
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Welcome Screen -->
    <div *ngIf="!selectedThread" class="welcome-screen">
      <div class="welcome-content">
        <h1>How can I help you today?</h1>
      </div>
      <div class="welcome-input">
        <div class="input-container">
          <textarea 
            [(ngModel)]="currentMessage"
            (keydown)="onKeyPress($event)"
            (input)="autoResize($event)"
            placeholder="Message ZackGPT..."
            class="message-input"
            rows="1"
            #welcomeInput></textarea>
          <button 
            class="send-btn" 
            (click)="sendMessage()"
            [disabled]="!currentMessage.trim()">
            <span class="send-icon">→</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Chat Interface -->
    <div *ngIf="selectedThread" class="chat-interface">
      <!-- Messages -->
      <div class="messages-container" #messagesContainer>
        <div *ngFor="let message of messages" class="message-wrapper">
          <div *ngIf="message.role === 'user'" class="user-message">
            <div class="message-content">{{ message.content }}</div>
          </div>
          
          <div *ngIf="message.role === 'assistant'" class="ai-message">
            <div class="ai-avatar">AI</div>
            <div class="message-content" [innerHTML]="formatMessage(message.content)"></div>
          </div>
        </div>

        <!-- Typing Indicator -->
        <div *ngIf="isTyping" class="typing-indicator">
          <div class="ai-avatar">AI</div>
          <div class="typing-dots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
          </div>
        </div>
      </div>

      <!-- Chat Input -->
      <div class="chat-input">
        <div class="input-container">
          <textarea 
            [(ngModel)]="currentMessage"
            (keydown)="onKeyPress($event)"
            (input)="autoResize($event)"
            placeholder="Message ZackGPT..."
            class="message-input"
            rows="1"
            [disabled]="isTyping"
            #chatInput></textarea>
          <button 
            class="send-btn" 
            (click)="sendMessage()"
            [disabled]="!currentMessage.trim() || isTyping">
            <span class="send-icon">→</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div> 